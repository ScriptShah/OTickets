import{d as Y,b as o,E as I,m as A,i as u,h as t,o as y,a as r,g as i,C as se,j as B,y as Z,G as J,f as re,w as ye,u as he,z as _e,q as be,c as E,n as xe,v as ke,F as z,l as we,k as $e,x as De,t as G}from"./index-28d7808a.js";import{_ as qe,a as M,b as Te,T as Ce}from"./TableSkeleton-b5bcf82c.js";import{_ as Ee}from"./ActionButton.vue_vue_type_script_setup_true_lang-a5ee823d.js";import{_ as Me,a as Ne,b as Se,r as oe}from"./ExclamationTriangleIcon-54e3cae4.js";import{r as Be,_ as Ae}from"./PlusIcon-1afde447.js";import{u as Ie,a as Re,o as Ve}from"./switch-6008f224.js";import{_ as je,a as Le}from"./PrimaryButton.vue_vue_type_script_setup_true_lang-a98f89af.js";import{r as Ue}from"./MagnifyingGlassIcon-7b7d515e.js";import{r as Fe}from"./InformationCircleIcon-4d06df1d.js";import{a as Oe}from"./global-6426d760.js";import{u as Pe}from"./dashboard-51967606.js";import{g as ze}from"./getDepartments-3ecae0aa.js";import{l as Ge}from"./lodash-00fe4291.js";import{M as H}from"./menu-880c2858.js";import"./ChevronRightIcon-af9613bc.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./EllipsisHorizontalIcon-f2ab61ca.js";import"./SectionHeader.vue_vue_type_script_setup_true_lang-7b13873f.js";import"./XMarkIcon-cf8614b7.js";import"./transition-d11ecd8d.js";import"./use-tracked-pointer-3831155a.js";import"./dialog-4ee4193f.js";import"./emptyResults-4bcd933a.js";import"./use-controllable-fce04192.js";import"./FormLabel.vue_vue_type_script_setup_true_lang-7c85f56e.js";import"./vue.runtime.esm-bundler-e8cc2f2c.js";const He=Y({__name:"TrashSwitch",props:{value:{type:[Boolean,null]}},emits:["change"],setup(d,{emit:c}){const l=d,e=o(l.value??!1);return I(e,a=>{c("change",a)}),I(()=>l.value,a=>{e.value=a??!1}),(a,m)=>(y(),A(t(Ve),{as:"div",class:"flex items-center gap-2"},{default:u(()=>[r(t(Ie),{modelValue:e.value,"onUpdate:modelValue":m[0]||(m[0]=v=>e.value=v),class:se([e.value?"bg-teal-600":"bg-gray-200","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2"])},{default:u(()=>[i("div",{"aria-hidden":"true",class:se([e.value?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out"])},null,2)]),_:1},8,["modelValue","class"]),r(t(Re),{as:"div"},{default:u(()=>[B("Trash")]),_:1})]),_:1}))}}),X=o({}),x=o(""),k=o(!1),w=o(!1),Je=async(d,c,l=null)=>{X.value={},k.value=!0,w.value=!1;const e=l?`/departments/${l}`:"/departments";await Z.post(e,{...d,_method:c}).then(a=>{x.value=a.data.message,w.value=!0}).catch(a=>{var m;X.value=(m=a.response)==null?void 0:m.data.errors,x.value="Please check the errors"}).then(()=>k.value=!1)},Ke=async d=>{k.value=!0,w.value=!1,await Z.put(`/departments/${d}/restore`).then(c=>{x.value=c.data.message,w.value=!0}).catch(c=>{var l;x.value=(l=c.response)==null?void 0:l.data.message}).then(()=>k.value=!1)},Qe=async(d,c=!1)=>{k.value=!0,w.value=!1;const l=c?`/departments/${d}/force-delete`:`/departments/${d}`;await Z.delete(l).then(e=>{x.value=e.data.message,w.value=!0}).catch(e=>{var a;x.value=(a=e.response)==null?void 0:a.data.message}).then(()=>k.value=!1)},le=()=>({errors:X,isLoading:k,isSuccess:w,message:x,save:Je,destroy:Qe,restore:Ke}),We=["onSubmit"],Xe={class:"p-6"},Ye={class:"mt-3 flex justify-end border-t bg-gray-50 px-6 py-3"},Ze=Y({__name:"DepartmentModal",props:{open:{type:Boolean},departmentToEdit:null},emits:["close","success"],setup(d,{emit:c}){const l=d,e=o(""),a=J(()=>l.departmentToEdit.id?"put":"post"),m=o(!1),v=J(()=>l.departmentToEdit.id?"Edit Department":"New Department"),R=J(()=>l.departmentToEdit.id?"Update":"Create"),p=re(),{save:N,isLoading:S,isSuccess:V,errors:$,message:j}=le(),f=()=>{m.value=!0,e.value=""},D=async()=>{await N({name:e.value},a.value,l.departmentToEdit.id??null),V.value?(p.success(j.value),f(),a.value==="post"?c("success",!1):c("success",!0),c("close")):p.error(j.value)};return I(()=>l.departmentToEdit,()=>{l.departmentToEdit.id?e.value=l.departmentToEdit.name:f()}),(q,g)=>(y(),A(Me,{open:d.open,onClose:g[2]||(g[2]=b=>q.$emit("close")),title:t(v)},{default:u(()=>[i("form",{onSubmit:ye(D,["prevent"])},[i("div",Xe,[r(je,{class:"w-full",id:"name",label:"Name",placeholder:"Name",type:"text",value:e.value,onChange:g[0]||(g[0]=b=>e.value=b),errors:t($).name,reset:m.value,onReset:g[1]||(g[1]=()=>m.value=!1)},null,8,["value","errors","reset"])]),i("div",Ye,[r(Le,{type:"submit",text:t(R),loading:t(S)},null,8,["text","loading"])])],40,We)]),_:1},8,["open","title"]))}}),et={class:"mb-3 flex flex-col justify-between gap-3 sm:flex-row-reverse"},tt={class:"flex justify-end sm:justify-start"},at={class:"flex flex-1 gap-3"},st={class:"w-full max-w-sm"},ot=i("label",{for:"search",class:"sr-only"},"Search",-1),rt={class:"relative rounded-md shadow-sm"},lt={class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},nt=["onClick"],ut=["onClick"],it=["onClick"],ct=["onClick"],dt={key:1},pt=i("p",{class:"p-6 text-center text-xl"},"No departments yet",-1),Lt=Y({__name:"Departments",setup(d){he({title:`Departments | ${Oe}`});const{setTitle:c}=Pe();c("Departments");const l=["Department","Agents","Categories","Created At",""],e=we(),a=o({page:isNaN(Number(e.query.page))?null:Number(e.query.page),query:e.query.query??null,trash:e.query.trash==="true"?!0:null,paginate:!0}),m=J(()=>a.value.query||a.value.trash),{load:v,isLoading:R,paginatedDepartments:p}=ze(a),N=o(e.query.query??""),S=$e();I(N,Ge.debounce(async function(s){a.value.query=s;const n={};s&&(n.query=s),a.value.trash&&(n.trash=a.value.trash),S.push({query:n})},300));const V=o(!!(e.query.trash??!1));I(V,s=>{a.value.trash=s;const n={};s&&(n.trash=s),S.push({query:n})}),_e(async(s,n)=>{s.query.page!==n.query.page&&(a.value={...a.value,page:Number(s.query.page)}),await v()}),be(async()=>{await v()});const $=o(!1),j=async s=>{Object.keys(e.query).length?s?await v():S.push({query:{}}):await v()},f=o(!1),D=o(""),q=o(""),g=o(""),b=o(""),L=o(""),U=o(""),F=o({}),O=o({}),{destroy:ee,restore:ne,message:T,isSuccess:K,isLoading:ue}=le(),ie=()=>{Q.value={},$.value=!0},Q=o({}),ce=s=>{Q.value=s,$.value=!0},P=o({}),de=s=>{P.value=s,f.value=!0,D.value="Delete Department",q.value="Are you sure you want to delete this department?",g.value="Delete",b.value="bg-red-100",L.value="bg-red-600 hover:bg-red-700 focus:ring-red-500",U.value="text-red-600",F.value=oe,O.value=ve},pe=s=>{P.value=s,f.value=!0,D.value="Permanent Delete Department",q.value="Are you sure you want to permanently delete this department? This action cannot be undone.",g.value="Delete",b.value="bg-red-100",L.value="bg-red-600 hover:bg-red-700 focus:ring-red-500",U.value="text-red-600",F.value=oe,O.value=fe},te=o({}),me=s=>{te.value=s,f.value=!0,D.value="Restore Department",q.value="Are you sure you want to restore this department?",g.value="Restore",b.value="bg-teal-100",L.value="bg-teal-600 hover:bg-teal-700 focus:ring-teal-500",U.value="text-teal-600",F.value=Fe,O.value=ge},C=re(),ve=async()=>{await ee(P.value.id),f.value=!1,K.value?(C.success(T.value),await v()):C.error(T.value)},fe=async()=>{await ee(P.value.id,!0),f.value=!1,K.value?(C.success(T.value),await v()):C.error(T.value)},ge=async()=>{await ne(te.value.id),f.value=!1,K.value?(C.success(T.value),await v()):C.error(T.value)};return(s,n)=>{var ae;return y(),E(z,null,[r(Ze,{open:$.value,departmentToEdit:Q.value,onClose:n[0]||(n[0]=h=>$.value=!1),onSuccess:j},null,8,["open","departmentToEdit"]),r(Ne,{title:D.value,open:f.value,text:q.value,"button-text":g.value,"is-loading":t(ue),Icon:F.value,color:U.value,"background-color":b.value,onClose:n[1]||(n[1]=h=>f.value=!1),onConfirm:n[2]||(n[2]=h=>O.value()),"button-background-color":L.value},null,8,["title","open","text","button-text","is-loading","Icon","color","background-color","button-background-color"]),i("header",et,[i("div",tt,[r(Ee,{Icon:t(Be),text:"New Department",action:ie},null,8,["Icon"])]),i("div",at,[i("div",st,[ot,i("div",rt,[i("div",lt,[r(t(Ue),{class:"h-5 w-5 text-gray-400"})]),xe(i("input",{"onUpdate:modelValue":n[3]||(n[3]=h=>N.value=h),type:"search",name:"search",id:"search",class:"block w-full rounded-md border-gray-300 pl-10 text-sm focus:border-teal-500 focus:ring-teal-500",placeholder:"Search"},null,512),[[ke,N.value]])])]),r(He,{value:a.value.trash,onChange:n[4]||(n[4]=h=>V.value=h)},null,8,["value"])])]),t(R)?(y(),A(Ce,{key:0})):!t(R)&&!((ae=t(p).data)!=null&&ae.length)&&t(m)?(y(),A(Ae,{key:1,text:"No departments related to your search"})):(y(),A(qe,{key:2,headers:l},{default:u(()=>{var h;return[(h=t(p).data)!=null&&h.length?(y(!0),E(z,{key:0},De(t(p).data,_=>(y(),E("tr",{key:_.id},[r(M,null,{default:u(()=>[B(G(_.name),1)]),_:2},1024),r(M,null,{default:u(()=>[B(G(_.agents_count),1)]),_:2},1024),r(M,null,{default:u(()=>[B(G(_.categories_count),1)]),_:2},1024),r(M,null,{default:u(()=>[B(G(_.created_at),1)]),_:2},1024),r(M,null,{default:u(()=>[r(Se,null,{default:u(()=>[s.$route.query.trash!="true"?(y(),E(z,{key:0},[r(t(H),{class:"cursor-pointer"},{default:u(()=>[i("div",{onClick:W=>ce(_),class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"}," Edit ",8,nt)]),_:2},1024),r(t(H),{class:"cursor-pointer"},{default:u(()=>[i("div",{onClick:W=>de(_),class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"}," Delete ",8,ut)]),_:2},1024)],64)):(y(),E(z,{key:1},[r(t(H),{class:"cursor-pointer"},{default:u(()=>[i("div",{onClick:W=>me(_),class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"}," Restore ",8,it)]),_:2},1024),r(t(H),{class:"cursor-pointer"},{default:u(()=>[i("div",{onClick:W=>pe(_),class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"}," Delete permanently ",8,ct)]),_:2},1024)],64))]),_:2},1024)]),_:2},1024)]))),128)):(y(),E("tr",dt,[r(M,{colspan:"5"},{default:u(()=>[pt]),_:1})]))]}),pagination:u(()=>[r(Te,{class:"border-t bg-gray-50 py-2 px-3",from:t(p).from,to:t(p).to,total:t(p).total,prev_page_url:t(p).prev_page_url,next_page_url:t(p).next_page_url,links:t(p).links,"route-name":"DashboardDepartments",query:{trash:s.$route.query.trash,query:s.$route.query.query}},null,8,["from","to","total","prev_page_url","next_page_url","links","query"])]),_:1}))],64)}}});export{Lt as default};
