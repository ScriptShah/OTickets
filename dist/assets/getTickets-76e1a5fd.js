import{_ as P,a as j}from"./debounce-fafd0e7f.js";import{_ as T}from"./ListBox.vue_vue_type_script_setup_true_lang-9258f04c.js";import{_ as x}from"./Autocomplete.vue_vue_type_script_setup_true_lang-30be75d0.js";import{_ as z}from"./DatesPicker.vue_vue_type_script_setup_true_lang-c68c7fba.js";import{g as G}from"./getUsers-cc3347f2.js";import{g as J}from"./getClients-3787ad9e.js";import{b as h}from"./global-6426d760.js";import{d as K,b as s,e as Q,s as W,q as X,E as Y,m as Z,i as ee,o as I,g as te,h as le,c as ae,a as o,F as se,A as ne,y as oe}from"./index-28d7808a.js";const ie={class:"relative mt-6 flex-1 space-y-5 px-4 sm:px-6"},ge=K({__name:"FilterTickets",props:{open:{type:Boolean},filters:null,tempCategories:null},emits:["close","reset","filter"],setup(p,{emit:m}){const a=p,i=[{name:"Low",value:"low"},{name:"Medium",value:"medium"},{name:"High",value:"high"}],u=s({}),g=[{name:"Unassigned",value:"unassigned"},{name:"Assigned",value:"assigned"},{name:"Resolved",value:"resolved"},{name:"Closed",value:"closed"}],y=s(a.filters.trash??!1),d=s({}),S=s([]),r=s({}),C=s([]),f=s({}),A=s([]),c=s({}),L=s({role:"agent"}),{load:R,users:V}=G(L),D=s({}),{load:E,clients:M}=J(D),O=Q(),{isAdmin:b}=W(O);X(async()=>{var n,t;b.value&&(await R(),A.value=V.value.map(e=>{var l;return{name:e.name,value:e.id.toString(),email:e.email,picture:h+e.picture,department:(l=e.department)==null?void 0:l.name}}),await E(),C.value=M.value.map(e=>({name:e.name,value:e.id.toString(),email:e.email,picture:h+e.picture})),a.filters.client&&(f.value=C.value.find(e=>{var l;return e.value===((l=a.filters.client)==null?void 0:l.toString())})),a.filters.agent&&(c.value=A.value.find(e=>{var l;return e.value===((l=a.filters.agent)==null?void 0:l.toString())}))),a.filters.priority&&(u.value=i.find(e=>{var l;return e.value===((l=a.filters.priority)==null?void 0:l.toString())})),a.filters.status&&(d.value=g.find(e=>{var l;return e.value===((l=a.filters.status)==null?void 0:l.toString())})),a.filters.category&&(r.value=S.value.find(e=>{var l;return e.value===((l=a.filters.category)==null?void 0:l.toString())})),a.filters.dates&&(v.value=[new Date((n=a.filters.dates)==null?void 0:n[0]),new Date((t=a.filters.dates)==null?void 0:t[1])])}),Y(()=>a.tempCategories,n=>{S.value=n.map(t=>({name:t.name,value:t.id.toString()}))});const v=s([]),q=()=>{var e,l,w,U,k,N,$,B,F,_;const n=isNaN(Number((e=r.value)==null?void 0:e.value))?null:Number((l=r.value)==null?void 0:l.value),t={trash:y.value,client:((w=f.value)==null?void 0:w.value)??null,agent:((U=c.value)==null?void 0:U.value)??null,status:((k=d.value)==null?void 0:k.value)??null,priority:((N=u.value)==null?void 0:N.value)??null,category:n,dates:[((B=($=v.value)==null?void 0:$[0])==null?void 0:B.toISOString().slice(0,10))??null,((_=(F=v.value)==null?void 0:F[1])==null?void 0:_.toISOString().slice(0,10))??null]};m("filter",t)},H=()=>{y.value=!1,f.value={},c.value={},u.value={},d.value={},r.value={},v.value=[],m("reset")};return(n,t)=>(I(),Z(P,{filter:q,reset:H,open:p.open,onClose:t[7]||(t[7]=e=>n.$emit("close"))},{default:ee(()=>[te("div",ie,[le(b)?(I(),ae(se,{key:0},[o(j,{label:"Trash",value:y.value,onChange:t[0]||(t[0]=e=>y.value=e)},null,8,["value"]),o(x,{onUpdate:t[1]||(t[1]=e=>f.value=e),label:"Client",options:C.value,selected:f.value,"null-text":"All"},null,8,["options","selected"]),o(x,{onUpdate:t[2]||(t[2]=e=>c.value=e),label:"Agent",options:A.value,selected:c.value,"null-text":"All"},null,8,["options","selected"])],64)):ne("",!0),o(T,{onUpdate:t[3]||(t[3]=e=>u.value=e),label:"Priority",options:i,selected:u.value,"null-text":"All"},null,8,["selected"]),o(T,{onUpdate:t[4]||(t[4]=e=>d.value=e),label:"Status",options:g,selected:d.value,"null-text":"All"},null,8,["selected"]),o(x,{onUpdate:t[5]||(t[5]=e=>r.value=e),label:"Category",options:S.value,selected:r.value,"null-text":"All"},null,8,["options","selected"]),o(z,{onUpdate:t[6]||(t[6]=e=>v.value=e),dates:v.value},null,8,["dates"])])]),_:1},8,["open"]))}}),ye=p=>{const m=s({}),a=s(!1),i=s(!0);return{load:async()=>{i.value=!0,a.value=!1,await oe.get("/tickets",{params:p.value}).then(g=>m.value=g.data.data).catch(()=>a.value=!0).finally(()=>i.value=!1)},tickets:m,error:a,isLoading:i}};export{ge as _,ye as g};
