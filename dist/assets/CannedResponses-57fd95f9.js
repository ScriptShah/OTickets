import{b as s,y as ne,d as oe,G as Y,f as ie,E as P,m as F,i as m,h as o,o as q,g as c,a as u,w as ke,e as ce,s as de,q as ve,A as Ne,u as Te,z as we,c as V,n as Se,v as Ee,F as K,l as Ae,k as Me,x as De,j as Q,t as W}from"./index-28d7808a.js";import{_ as Ie,a as O,b as Be,T as Ue}from"./TableSkeleton-b5bcf82c.js";import{_ as je,a as Le,b as Ve,r as ue}from"./ExclamationTriangleIcon-54e3cae4.js";import{_ as Oe,a as Pe}from"./PrimaryButton.vue_vue_type_script_setup_true_lang-a98f89af.js";import{_ as ae}from"./Autocomplete.vue_vue_type_script_setup_true_lang-30be75d0.js";import{_ as Fe}from"./FormTextarea.vue_vue_type_script_setup_true_lang-e263282d.js";import{_ as ze,a as Ge,d as He,r as Je}from"./debounce-fafd0e7f.js";import{_ as Ke}from"./ActionButton.vue_vue_type_script_setup_true_lang-a5ee823d.js";import{r as Qe,_ as We}from"./PlusIcon-1afde447.js";import{r as Xe}from"./MagnifyingGlassIcon-7b7d515e.js";import{r as Ye}from"./InformationCircleIcon-4d06df1d.js";import{a as Ze}from"./global-6426d760.js";import{u as et}from"./dashboard-51967606.js";import{g as tt}from"./getCannedResponses-3bd3d524.js";import{g as at}from"./getCategories-ebf7ea6c.js";import{g as st}from"./getUsers-cc3347f2.js";import{M as X}from"./menu-880c2858.js";import"./ChevronRightIcon-af9613bc.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./EllipsisHorizontalIcon-f2ab61ca.js";import"./SectionHeader.vue_vue_type_script_setup_true_lang-7b13873f.js";import"./XMarkIcon-cf8614b7.js";import"./transition-d11ecd8d.js";import"./use-tracked-pointer-3831155a.js";import"./dialog-4ee4193f.js";import"./FormLabel.vue_vue_type_script_setup_true_lang-7c85f56e.js";import"./vue.runtime.esm-bundler-e8cc2f2c.js";import"./combobox-f45cc6e0.js";import"./use-controllable-fce04192.js";import"./switch-6008f224.js";import"./emptyResults-4bcd933a.js";const se=s({}),D=s(""),I=s(!1),B=s(!1),nt=async(d,v,t=null)=>{se.value={},I.value=!0,B.value=!1;const g=t?`/canned-responses/${t}`:"/canned-responses";await ne.post(g,{...d,_method:v}).then(r=>{D.value=r.data.message,B.value=!0}).catch(r=>{var e;se.value=(e=r.response)==null?void 0:e.data.errors,D.value="Please check the errors"}).then(()=>{I.value=!1})},ot=async d=>{I.value=!0,B.value=!1,await ne.put(`/canned-responses/${d}/restore`).then(v=>{D.value=v.data.message,B.value=!0}).catch(v=>{var t;D.value=(t=v.response)==null?void 0:t.data.message}).then(()=>{I.value=!1})},lt=async(d,v=!1)=>{I.value=!0,B.value=!1;const t=v?`/canned-responses/${d}/force-delete`:`/canned-responses/${d}`;await ne.delete(t).then(g=>{D.value=g.data.message,B.value=!0}).catch(g=>{var r;D.value=(r=g.response)==null?void 0:r.data.message}).then(()=>{I.value=!1})},pe=()=>({errors:se,isLoading:I,isSuccess:B,message:D,save:nt,destroy:lt,restore:ot}),rt=["onSubmit"],ut={class:"space-y-4 p-6"},it={class:"mt-3 flex justify-end border-t bg-gray-50 px-6 py-3"},ct=oe({__name:"CannedResponseModal",props:{open:{type:Boolean},agents:null,categories:null,cannedResponseToEdit:null},emits:["close","success"],setup(d,{emit:v}){const t=d,g=s(""),r=s(""),e=s({}),f=s({}),p=Y(()=>t.cannedResponseToEdit.id?"put":"post"),T=s(!1),_=Y(()=>t.cannedResponseToEdit.id?"Edit Canned Response":"New Canned Response"),$=Y(()=>t.cannedResponseToEdit.id?"Update":"Create"),i=ie(),{save:y,isLoading:S,isSuccess:h,errors:R,message:w}=pe(),A=()=>{T.value=!0,g.value="",r.value="",e.value={},f.value={}},U=async()=>{var b,M,E,z;const x=isNaN(Number((b=e.value)==null?void 0:b.value))?null:Number((M=e.value)==null?void 0:M.value),l=isNaN(Number((E=f.value)==null?void 0:E.value))?null:Number((z=f.value)==null?void 0:z.value);await y({title:g.value,content:r.value,agent_id:x,category_id:l},p.value,t.cannedResponseToEdit.id??null),h.value?(i.success(w.value),A(),p.value==="post"?v("success",!1):v("success",!0),v("close")):i.error(w.value)};return P(()=>t.cannedResponseToEdit,()=>{t.cannedResponseToEdit.id?(g.value=t.cannedResponseToEdit.title,r.value=t.cannedResponseToEdit.content):A()}),P(()=>t.agents&&t.cannedResponseToEdit,()=>{t.cannedResponseToEdit.id&&(e.value=t.agents.find(x=>{var l;return x.value===((l=t.cannedResponseToEdit.agent)==null?void 0:l.id.toString())})??{})}),P(()=>t.categories&&t.cannedResponseToEdit,()=>{t.cannedResponseToEdit.id&&(f.value=t.categories.find(x=>{var l;return x.value===((l=t.cannedResponseToEdit.category)==null?void 0:l.id.toString())})??{})}),(x,l)=>(q(),F(je,{open:d.open,onClose:l[5]||(l[5]=b=>x.$emit("close")),title:o(_)},{default:m(()=>[c("form",{onSubmit:ke(U,["prevent"])},[c("div",ut,[u(Oe,{class:"w-full",id:"title",label:"Title",placeholder:"Title",type:"text",value:g.value,onChange:l[0]||(l[0]=b=>g.value=b),errors:o(R).title,reset:T.value,onReset:l[1]||(l[1]=()=>T.value=!1)},null,8,["value","errors","reset"]),u(Fe,{id:"content",label:"Content",placeholder:"Content",value:r.value,onChange:l[2]||(l[2]=b=>r.value=b),errors:o(R).content},null,8,["value","errors"]),u(ae,{"null-text":"Select a category",class:"w-full",label:"Category",selected:f.value,options:d.categories,onUpdate:l[3]||(l[3]=b=>f.value=b),errors:o(R).category_id,reset:T.value,onReset:l[4]||(l[4]=()=>T.value=!1)},null,8,["selected","options","errors","reset"])]),c("div",it,[u(Pe,{type:"submit",text:o($),loading:o(S)},null,8,["text","loading"])])],40,rt)]),_:1},8,["open","title"]))}}),dt={class:"relative mt-6 flex-1 space-y-6 px-4 sm:px-6"},vt=oe({__name:"FilterCannedResponses",props:{open:{type:Boolean},filters:null,agents:null,categories:null},emits:["close","reset","filter"],setup(d,{emit:v}){const t=d,g=ce(),{isAdmin:r}=de(g),e=s({}),f=s({}),p=s(!1);ve(async()=>{t.filters.trash&&(p.value=t.filters.trash.toString()=="true")}),P(()=>t.agents,()=>{t.filters.agent&&(e.value=t.agents.find($=>{var i;return $.value===((i=t.filters.agent)==null?void 0:i.toString())}))}),P(()=>t.categories,()=>{t.filters.category&&(f.value=t.categories.find($=>{var i;return $.value===((i=t.filters.category)==null?void 0:i.toString())}))});const T=()=>{var S,h,R,w;const $=isNaN(Number((S=e.value)==null?void 0:S.value))?null:Number((h=e.value)==null?void 0:h.value),i=isNaN(Number((R=f.value)==null?void 0:R.value))?null:Number((w=f.value)==null?void 0:w.value),y={trash:p.value,agent:$,category:i};v("filter",y)},_=()=>{p.value=!1,e.value={},f.value={},v("reset")};return($,i)=>(q(),F(ze,{filter:T,reset:_,open:d.open,onClose:i[3]||(i[3]=y=>$.$emit("close"))},{default:m(()=>[c("div",dt,[u(Ge,{label:"Trash",value:p.value,onChange:i[0]||(i[0]=y=>p.value=y)},null,8,["value"]),o(r)?(q(),F(ae,{key:0,onUpdate:i[1]||(i[1]=y=>e.value=y),label:"Agent",options:d.agents,selected:e.value,"null-text":"All"},null,8,["options","selected"])):Ne("",!0),u(ae,{onUpdate:i[2]||(i[2]=y=>f.value=y),label:"Category",options:d.categories,selected:f.value,"null-text":"All"},null,8,["options","selected"])])]),_:1},8,["open"]))}}),pt={class:"mb-3 flex flex-col justify-between gap-3 sm:flex-row-reverse"},gt={class:"flex justify-end sm:justify-start"},ft={class:"flex flex-1 gap-3"},mt={class:"w-full max-w-sm"},yt=c("label",{for:"search",class:"sr-only"},"Search",-1),bt={class:"relative rounded-md shadow-sm"},_t={class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},ht=c("span",null,"Filter",-1),xt=["onClick"],Ct=["onClick"],qt=["onClick"],$t=["onClick"],Rt={key:1},kt=c("p",{class:"p-6 text-center text-xl"},"No canned responses yet",-1),na=oe({__name:"CannedResponses",setup(d){Te({title:`Canned Responses | ${Ze}`});const v=ce(),{isAdmin:t}=de(v),{setTitle:g}=et();g("Canned Responses");const r=Ae(),e=s({page:isNaN(Number(r.query.page))?null:Number(r.query.page),query:r.query.query??null,agent:isNaN(Number(r.query.agent))?null:Number(r.query.agent),category:isNaN(Number(r.query.category))?null:Number(r.query.category),trash:r.query.trash,paginate:!0}),f=Y(()=>e.value.query||e.value.agent||e.value.category||e.value.trash),{load:p,isLoading:T,paginatedCannedResponses:_}=tt(e),$=async a=>{Object.keys(r.query).length?a?await p():H.push({query:{}}):await p()},i=s([]),y=s([]);ve(async()=>{await p();const{load:a,categories:n}=at();await a(),i.value=n.value.map(C=>({name:C.name,value:C.id.toString()}));const J=s({role:"agent",paginate:!1}),{load:k,users:N}=st(J);t.value&&(await k(),y.value=N.value.map(C=>({name:C.name,value:C.id.toString()})))});const S=s(!1),h=s(!1),R=s(""),w=s(""),A=s(""),U=s(""),x=s(""),l=s(""),b=s({}),M=s({}),E=s(!1),z=()=>{Z.value={},S.value=!0},Z=s({}),ge=a=>{Z.value=a,S.value=!0},G=s({}),fe=a=>{G.value=a,h.value=!0,R.value="Delete Canned Response",w.value="Are you sure you want to delete this canned response?",A.value="Delete",U.value="bg-red-100",x.value="bg-red-600 hover:bg-red-700 focus:ring-red-500",l.value="text-red-600",b.value=ue,M.value=he},me=a=>{G.value=a,h.value=!0,R.value="Permanent Delete Canned Response",w.value="Are you sure you want to permanently delete this canned response? This action cannot be undone.",A.value="Delete",U.value="bg-red-100",x.value="bg-red-600 hover:bg-red-700 focus:ring-red-500",l.value="text-red-600",b.value=ue,M.value=xe},le=s({}),ye=a=>{le.value=a,h.value=!0,R.value="Restore Canned Response",w.value="Are you sure you want to restore this canned response?",A.value="Restore",U.value="bg-teal-100",x.value="bg-teal-600 hover:bg-teal-700 focus:ring-teal-500",l.value="text-teal-600",b.value=Ye,M.value=Ce},j=ie(),{destroy:re,restore:be,isLoading:_e,message:L,isSuccess:ee}=pe(),he=async()=>{await re(G.value.id),h.value=!1,ee.value?(j.success(L.value),await p()):j.error(L.value)},xe=async()=>{await re(G.value.id,!0),h.value=!1,ee.value?(j.success(L.value),await p()):j.error(L.value)},Ce=async()=>{await be(le.value.id),h.value=!1,ee.value?(j.success(L.value),await p()):j.error(L.value)},qe=["Title","Category","Agent","Created At",""],H=Me(),te=s(e.value.query??"");P(te,He(async function(a){e.value.query=a;const n={};a&&(n.query=a),e.value.trash&&(n.trash=e.value.trash),e.value.agent&&(n.agent=e.value.agent),e.value.category&&(n.category=e.value.category),H.push({query:n})},300));const $e=async a=>{E.value=!1,e.value={...a,query:e.value.query,paginate:!0};const n={};n.trash=a.trash,e.value.query&&(n.query=e.value.query),a.agent&&(n.agent=a.agent),a.category&&(n.category=a.category),H.push({query:n})},Re=async()=>{if(E.value=!1,e.value.trash||e.value.agent||e.value.category){const a={};e.value.query?(e.value={query:e.value.query,paginate:!0},a.query=e.value.query):e.value={paginate:!0},H.push({query:a})}};return we(async(a,n)=>{a.query.page&&a.query.page!==n.query.page&&(e.value={...e.value,page:+a.query.page}),await p()}),(a,n)=>{var J;return q(),V(K,null,[u(ct,{open:S.value,agents:y.value,categories:i.value,"canned-response-to-edit":Z.value,onClose:n[0]||(n[0]=k=>S.value=!1),onSuccess:$},null,8,["open","agents","categories","canned-response-to-edit"]),u(Le,{title:R.value,open:h.value,text:w.value,"button-text":A.value,"is-loading":o(_e),Icon:b.value,color:l.value,"background-color":U.value,onClose:n[1]||(n[1]=k=>h.value=!1),onConfirm:n[2]||(n[2]=k=>M.value()),"button-background-color":x.value},null,8,["title","open","text","button-text","is-loading","Icon","color","background-color","button-background-color"]),u(vt,{agents:y.value,categories:i.value,filters:e.value,open:E.value,onClose:n[3]||(n[3]=k=>E.value=!1),onFilter:$e,onReset:Re},null,8,["agents","categories","filters","open"]),c("header",pt,[c("div",gt,[u(Ke,{Icon:o(Qe),text:"New Canned Response",action:z},null,8,["Icon"])]),c("div",ft,[c("div",mt,[yt,c("div",bt,[c("div",_t,[u(o(Xe),{class:"h-5 w-5 text-gray-400"})]),Se(c("input",{"onUpdate:modelValue":n[4]||(n[4]=k=>te.value=k),type:"search",name:"search",id:"search",class:"block w-full rounded-md border-gray-300 pl-10 text-sm focus:border-teal-500 focus:ring-teal-500",placeholder:"Search"},null,512),[[Ee,te.value]])])]),c("button",{onClick:n[5]||(n[5]=k=>E.value=!0),type:"button",class:"relative -ml-px inline-flex items-center space-x-2 rounded-md border border-gray-300 bg-gray-50 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 focus:border-teal-500 focus:outline-none focus:ring-1 focus:ring-teal-500"},[u(o(Je),{class:"h-5 w-5 text-gray-400"}),ht])])]),o(T)?(q(),F(Ue,{key:0})):!o(T)&&!((J=o(_).data)!=null&&J.length)&&o(f)?(q(),F(We,{key:1,text:"No canned responses related to your search"})):(q(),F(Ie,{key:2,headers:qe},{default:m(()=>{var k;return[(k=o(_).data)!=null&&k.length?(q(!0),V(K,{key:0},De(o(_).data,N=>(q(),V("tr",{key:N.id},[u(O,null,{default:m(()=>[Q(W(N.title),1)]),_:2},1024),u(O,null,{default:m(()=>[Q(W(N.category.name),1)]),_:2},1024),u(O,null,{default:m(()=>{var C;return[Q(W(((C=N.agent)==null?void 0:C.name)??"--"),1)]}),_:2},1024),u(O,null,{default:m(()=>[Q(W(N.created_at),1)]),_:2},1024),u(O,null,{default:m(()=>[u(Ve,null,{default:m(()=>[a.$route.query.trash!="true"?(q(),V(K,{key:0},[u(o(X),{class:"cursor-pointer"},{default:m(()=>[c("div",{onClick:C=>ge(N),class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"}," Edit ",8,xt)]),_:2},1024),u(o(X),{class:"cursor-pointer"},{default:m(()=>[c("div",{onClick:C=>fe(N),class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"}," Delete ",8,Ct)]),_:2},1024)],64)):(q(),V(K,{key:1},[u(o(X),{class:"cursor-pointer"},{default:m(()=>[c("div",{onClick:C=>ye(N),class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"}," Restore ",8,qt)]),_:2},1024),u(o(X),{class:"cursor-pointer"},{default:m(()=>[c("div",{onClick:C=>me(N),class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"}," Delete permanently ",8,$t)]),_:2},1024)],64))]),_:2},1024)]),_:2},1024)]))),128)):(q(),V("tr",Rt,[u(O,{colspan:"5"},{default:m(()=>[kt]),_:1})]))]}),pagination:m(()=>[u(Be,{class:"border-t bg-gray-50 py-2 px-3",from:o(_).from,to:o(_).to,total:o(_).total,prev_page_url:o(_).prev_page_url,next_page_url:o(_).next_page_url,links:o(_).links,"route-name":"DashboardCannedResponses",query:{trash:a.$route.query.trash,query:a.$route.query.query,agent:a.$route.query.agent,category:a.$route.query.category}},null,8,["from","to","total","prev_page_url","next_page_url","links","query"])]),_:1}))],64)}}});export{na as default};
